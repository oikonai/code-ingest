# =============================================================================
# Docker Compose Environment Configuration
# =============================================================================
# Copy this file to .env for Docker Compose usage
# This configuration uses SurrealDB as the local vector database

# =============================================================================
# Vector Backend (SurrealDB for Docker)
# =============================================================================
VECTOR_BACKEND=surrealdb

# SurrealDB is accessed via Docker network
# These values match the docker-compose.yml configuration
SURREALDB_URL=http://surrealdb:8000
SURREALDB_NS=code_ingest
SURREALDB_DB=vectors
SURREALDB_USER=root
SURREALDB_PASS=root

# =============================================================================
# Required: Embedding Service (External)
# =============================================================================

# Cloudflare AI Gateway endpoint
# Format: https://gateway.ai.cloudflare.com/v1/{account_id}/{gateway_id}
EMBEDDING_ENDPOINT=https://gateway.ai.cloudflare.com/v1/YOUR_ACCOUNT_ID/YOUR_GATEWAY_ID

# Cloudflare AI Gateway token
CLOUDFLARE_AI_GATEWAY_TOKEN=your_cloudflare_token_here

# DeepInfra API key (provider key)
DEEPINFRA_API_KEY=your_deepinfra_api_key_here

# Embedding model (optional, has default)
EMBEDDING_MODEL=custom-deepinfra/Qwen/Qwen2.5-7B-Instruct-Embedding

# =============================================================================
# Required: GitHub Personal Access Token
# =============================================================================
# Create PAT with 'repo' scope at: https://github.com/settings/tokens
GITHUB_TOKEN=your_github_pat_token_here

# =============================================================================
# Optional: Ingestion Configuration
# =============================================================================

# Repository priority filter (high|medium|low|ALL)
# Controls which repos to ingest from config/repositories.yaml
PRIORITY=high

# =============================================================================
# Optional: MCP Health Endpoint
# =============================================================================

# Enable health endpoint (automatically enabled in Docker)
ENABLE_HEALTH_ENDPOINT=true
HEALTH_PORT=8001

# =============================================================================
# Notes for Docker Compose
# =============================================================================
# 1. Copy this file: cp .env.docker.example .env
# 2. Fill in your credentials (EMBEDDING_ENDPOINT, tokens, GITHUB_TOKEN)
# 3. Run: docker compose up
# 4. Check health: curl http://localhost:8001/health
# 5. MCP server ready when health status is "ready"
#
# The ingestion service will:
# - Wait for SurrealDB to be healthy
# - Clone repositories (if ./repos is empty)
# - Run ingestion pipeline
# - Exit when complete
#
# The MCP server will:
# - Wait for SurrealDB to be healthy
# - Start serving MCP requests
# - Expose health endpoint at :8001/health
# - Report "waiting_for_ingestion" until ingestion completes
